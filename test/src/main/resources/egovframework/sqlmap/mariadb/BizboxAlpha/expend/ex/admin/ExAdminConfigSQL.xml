<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<!-- Bizbox Alpha mariadb -->
<sqlMap namespace="ExAdminConfig">

	<!-- /* ################################################## */ -->
	<!-- /* [810000000]..회계 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810100000]..└ 지출결의 관리 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810101000]....└ 지출결의 확인 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810102000]....└ 지출결의 현황 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810103000]....└ 카드 사용 현황 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810200000]..└ 지출결의 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810201000]....└ 계정과목 설정 */ /* 관리자 > 회계 > 지출결의 설정 > 계정과목 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- 계정과목 목록 조회 -->
	<select id="ExAdminConfig.ExAdminConfigAcctListInfoSelect"
		parameterClass="HashMap" resultClass="HashMap"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigAcctListInfoSelect */
		SELECT  `acct_code` AS acctCode
		        , `acct_name` AS acctName
		        , `vat_yn` AS vatYN
		        , `use_yn` AS useYN
		FROM    $DB_NEOS$t_ex_acct
		WHERE   `comp_seq` = '$compSeq$'
		AND     (
		                ( '$useYN$' = '' AND `use_yn` = `use_yn` )
		                OR ( '$useYN$' != '' AND `use_yn` = '$useYN$' )
		        )
	]]></select>

	<!-- 계정과목 생성 & 수정 -->
	<update id="ExAdminConfig.ExAdminConfigAcctInfoInsert"
		parameterClass="HashMap"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigAcctInfoInsert */
		INSERT INTO $DB_NEOS$t_ex_acct ( `comp_seq`, `acct_code`, `acct_name`, `vat_yn`, `use_yn`, `parent_code`, `path`, `create_seq`, `create_date`, `modify_seq`, `modify_date` )
		VALUES ( '$compSeq$', '$acctCode$', '$acctName$', '$vatYN$', '$useYN$', '0', '0|', '$empSeq$', NOW(), '$empSeq$', NOW() )
		ON DUPLICATE KEY UPDATE `comp_seq` = '$compSeq$'
		                        , `acct_code` = '$acctCode$'
		                        , `acct_name` = '$acctName$'
		                        , `vat_yn` = '$vatYN$'
		                        , `use_yn` = '$useYN$'
		                        , `modify_seq` = '$empSeq$'
		                        , `modify_date` = NOW()
	]]></update>

	<!-- 계정과목 삭제 -->
	<delete id="ExAdminConfig.ExAdminConfigAcctInfoDelete"
		parameterClass="HashMap"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigAcctInfoDelete */
		DELETE
		FROM    $DB_NEOS$t_ex_acct
		WHERE   `comp_seq` = '$compSeq$'
		AND     `acct_code` = '$acctCode$'
	]]></delete>

	<!-- /* ################################################## */ -->
	<!-- /* [810202000]....└ 증빙 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810203000]....└ 카드 설정 */ /* 관리자 > 회계 > 지출결의 설정 > 카드 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810204000]....└ 표준적요 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810205000]....└ 증빙유형 설징 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810206000]....└ 환경 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810207000]....└ 양식 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810208000]....└ 항목 설정 */ /* 관리자 > 회계 > 지출결의 설정 > 항목 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- 항목 설정 목록 조회 -->
	<select id="ExAdminConfig.ExAdminConfigItemListInfoSelect"
		parameterClass="HashMap" resultClass="HashMap"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigItemListInfoSelect */
		SELECT	item.compSeq,
			item.formSeq,
			item.itemGbn,
			item.langpackCode,
			langpack.lang_name AS langpackName,
			item.orderNum,
			item.displayAlign,
			item.headCode,
			item.selectYN
		FROM(
				SELECT  '$compSeq$' AS compSeq
				        ,'$formSeq$' AS formSeq
				        , CASE WHEN B.`item_gbn` IS NOT NULL THEN B.`item_gbn` ELSE A.`item_gbn` END AS itemGbn
				        , CASE WHEN B.`langpack_code` IS NOT NULL THEN B.`langpack_code` ELSE A.`langpack_code` END AS langpackCode
				        , CASE WHEN B.`langpack_name` IS NOT NULL THEN B.`langpack_name` ELSE A.`langpack_name` END AS langpackName
				        , CASE WHEN B.`order_num` IS NOT NULL THEN B.`order_num` ELSE A.`order_num` END AS orderNum
				        , CASE WHEN B.`display_align` IS NOT NULL THEN B.`display_align` ELSE A.`display_align` END AS displayAlign
				        , CASE WHEN B.`head_code` IS NOT NULL THEN B.`head_code` ELSE A.`head_code` END AS headCode
				        , CASE WHEN B.`select_yn` IS NOT NULL THEN B.`select_yn` ELSE A.`select_yn` END AS selectYN
				FROM    (
				                SELECT  `comp_seq`
				                        , `form_seq`
				                        , `item_gbn`
				                        , `langpack_code`
				                        , `langpack_name`
				                        , IFNULL(`order_num`, 0) AS order_num
				                        , `display_align`
				                        , `head_code`
				                        , `select_yn`
				                FROM    $DB_NEOS$t_ex_item
				                WHERE   `comp_seq` = '0'
				                AND     `form_seq` = '0'
				        ) A LEFT OUTER JOIN (
				                SELECT  `comp_seq`
				                        , `form_seq`
				                        , `item_gbn`
				                        , `langpack_code`
				                        , `langpack_name`
				                        , IFNULL(`order_num`, 0) AS order_num
				                        , `display_align`
				                        , `head_code`
				                        , `select_yn`
				                FROM    $DB_NEOS$t_ex_item
				                WHERE   `comp_seq` = '$compSeq$'
				                AND     `form_seq` = '$formSeq$'
				        ) B ON A.`item_gbn` = B.`item_gbn` AND A.`langpack_code` = B.`langpack_code`
				WHERE   (
							( '$itemGbn$' = 'CODEALL' AND A.`item_gbn` = A.`item_gbn` )
							OR ( '$itemGbn$' != 'CODEALL' AND A.`item_gbn` IN ( 'ALL', '$itemGbn$' ) )
						)
		
			) item
		INNER JOIN $DB_NEOS$t_ex_langpack langpack
		ON item.langpackCode = langpack.lang_code
		WHERE lang_type ='$langCode$'
		ORDER   BY selectYN, orderNum, langpackName
	]]></select>

	<!-- 항목 설정 생성 & 수정 -->
	<update id="ExAdminConfig.ExAdminConfigItemInfoInsert"
		parameterClass="HashMap"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigItemInfoInsert */
		INSERT INTO $DB_NEOS$t_ex_item ( `comp_seq`, `form_seq`, `item_gbn`, `langpack_code`, `langpack_name`, `order_num`, `display_align`, `head_code`, `select_yn`, `create_seq`, `create_date`, `modify_seq`, `modify_date` )
		VALUES ( '$compSeq$', '$formSeq$', '$itemGbn$', '$langpackCode$', '$langpackName$', '$orderNum$', '$displayAlign$', '$headCode$', '$selectYN$', '$empSeq$', NOW(), '$empSeq$', NOW() )
		ON DUPLICATE KEY UPDATE `comp_seq` = '$compSeq$'
		                        , `form_seq` = '$formSeq$'
		                        , `item_gbn` = '$itemGbn$'
		                        , `langpack_code` = '$langpackCode$'
		                        , `langpack_name` = '$langpackName$'
		                        , `order_num` = '$orderNum$'
		                        , `display_align` = '$displayAlign$'
		                        , `head_code` = '$headCode$'
		                        , `select_yn` = '$selectYN$'
		                        , `modify_seq` = '$empSeq$'
		                        , `modify_date` = NOW()
	]]></update>

	<!-- 항목 설정 초기화 -->
	<delete id="ExAdminConfig.ExAdminConfigItemListInfoDelete"><![CDATA[
		/* mariadb - /expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.ExAdminConfigItemListInfoDelete */
		DELETE
		FROM    $DB_NEOS$t_ex_item
		WHERE   `comp_seq` = '$compSeq$'
		AND     `form_seq` = '$formSeq$'
		AND		`item_gbn` IN ( 'ALL', '$itemGbn$' )
	]]></delete>
	<!-- /* ################################################## */ -->
	<!-- /* [810209000]....└ 관리항목 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810210000]....└ 버튼 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810300000]..└ 자금관리 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810301000]....└ 자금일보 양식 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810302000]....└ 자금관리 권한 설정 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810400000]..└ G20 품의/결의서 관리 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810401000]....└ 예실대비 현황 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810402000]....└ 예산 단계별 현황 */ -->
	<!-- /* ################################################## */ -->
	<!-- /* ################################################## */ -->
	<!-- /* [810403000]....└ 품의/결의서 현황 */ -->
	<!-- /* ################################################## */ -->

	<!-- 관리자 카드설정 - 카드조회 -->
	<select id="ExCodeCardInfoSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL - ExCodeCardInfoSelect */
		/* 법인카드 설정페이지 / 카드 리스트 정보 조회 */
		SELECT	
			comp_seq 		AS compSeq
			, card_code		AS cardCode
			, card_num		AS cardNum
			, card_name		AS cardName
			, partner_code		AS partnerCode
			, partner_name		AS partnerName
			, card_public_json	AS cardPublicJson
			, use_yn		AS useYN
		FROM	$DB_NEOS$t_ex_card
		WHERE 	comp_Seq = '$compSeq$'
		AND	(
				REPLACE(card_num,'-','') LIKE REPLACE('%$textFilter$%','-','')
			OR	card_name LIKE '%$textFilter$%'
			OR	partner_code LIKE '%$textFilter$%'
			OR	partner_name LIKE '%$textFilter$%'
		)
		AND		use_yn LIKE '%$useYN$%'
		
	]]></select>

	<!-- 관리자 카드설정 - 카드조회 -->
	<select id="NpExCodeCardInfoSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL - NpExCodeCardInfoSelect */
		/* 법인카드 설정페이지 / 카드 리스트 정보 조회 */
		SELECT	
			comp_seq 		AS compSeq
			, card_code		AS cardCode
			, card_num		AS cardNum
			, card_name		AS cardName
			, partner_code		AS partnerCode
			, partner_name		AS partnerName
			, card_public_json	AS cardPublicJson
			, use_yn		AS useYN
		FROM	$DB_NEOS$t_ex_card
		WHERE 	comp_Seq = '$compSeq$'
		  AND   card_name like concat('%', IFNULL(#searchCardName#, ''),'%')
		  AND   REPLACE(card_num, '-', '') like concat('%', REPLACE(IFNULL(#searchCardNum#, ''), '-', ''),'%')
		  AND   partner_code like concat('%', '$searchPartnerCode$','%')
		  AND   partner_name like concat('%', IFNULL(#searchPartnerName#, ''),'%')
		  AND	card_public_json LIKE '%$public$%'
		  AND	use_yn LIKE '%$useYN$%'
		  	
	]]></select>

	<!-- 공통코드 - 카드등록 -->
	<insert id="ExCodeCardInfoInsert" parameterClass="HashMap"><![CDATA[
		/* ExCodeCardInfoInsert - BizboxA - mariaDB */
		INSERT IGNORE $DB_NEOS$t_ex_card (
		    comp_seq
		    , card_code
		    , card_num
		    , card_name
		    , partner_code
		    , partner_name
		    , card_public_json
		    , use_yn
		    , paytr_seq
		    , paytr_name
		    , create_seq
		    , create_date
		    , modify_seq
		    , modify_date )
		VALUES (
		    '$compSeq$'
		    , '$cardCode$'
		    , '$cardNum$'
		    , #cardName#
		    , '$partnerCode$'
		    , #partnerName#
		    , #cardPublicJson#
		    , '$useYN$'
		    , '$payTrSeq$'
		    , '$payTrName$'
		    , '$createSeq$'
		    , NOW()
		    , '$modifySeq$'
		    , NOW() )
	]]></insert>

	<!-- 공통코드 - 카드 수정 -->
	<update id="ExCodeCardInfoUpdate" parameterClass="HashMap"><![CDATA[
		/* ExCodeCardInfoUpdate - BizboxA - mariaDB */
		UPDATE  $DB_NEOS$t_ex_card
		SET     card_name = #cardName#
		        , partner_code = '$partnerCode$'
		        , partner_name = #partnerName#
		        , card_public_json = #cardPublicJson#
		        , modify_seq = '$modifySeq$'
		        , modify_date = NOW()
		WHERE   comp_seq = '$compSeq$'
		AND     ( REPLACE(card_num, '-', '') = REPLACE('$cardNum$', '-', '') OR card_num = '$cardCode$' )
	]]></update>

	<!-- 공통코드 - 카드 전체 삭제 -->
	<delete id="ExCodeCardInfoDeleteAll" parameterClass="HashMap"><![CDATA[
		/* ExCodeCardInfoDelete - BizboxA - mariaDB */
		DELETE
		FROM    $DB_NEOS$t_ex_card
		WHERE   comp_seq = '$compSeq$'
	]]></delete>

	<!-- 공통코드 - 카드 삭제 -->
	<delete id="ExCodeCardInfoDelete" parameterClass="HashMap"><![CDATA[
		/* ExCodeCardInfoDelete - BizboxA - mariaDB */
		DELETE
		FROM    $DB_NEOS$t_ex_card
		WHERE   comp_seq = '$compSeq$'
		AND     ( REPLACE(card_num, '-', '') = REPLACE('$cardNum$', '-', '') OR card_num = '$cardCode$' )
	]]></delete>

	<!-- 공통코드 - 카드 공개범위 등록 -->
	<insert id="ExCodeCardPublicListInfoInsert" parameterClass="HashMap"><![CDATA[
		INSERT IGNORE INTO $DB_NEOS$t_ex_card_public ( 
		    comp_seq
		    , card_num
		    , org_div
		    , org_id
		    , create_seq
		    , create_dt
		    , modify_seq
		    , modify_dt )
		VALUES (
		    '$compSeq$'
		    , '$cardNum$'
		    , '$orgDiv$'
		    , '$orgId$'
		    , '$createSeq$'
		    , NOW()
		    , '$modifySeq$'
		    , NOW() )
	]]></insert>

	<!-- 공통코드 - 카드 공개범위 삭제 -->
	<delete id="ExCodeCardPublicListInfoDelete" parameterClass="HashMap"><![CDATA[
		DELETE
		FROM    $DB_NEOS$t_ex_card_public
		WHERE   comp_seq = '$compSeq$'
		AND     ( REPLACE(card_num, '-', '') = REPLACE('$cardNum$', '-', '') OR card_num = '$cardCode$' )
	]]></delete>

	<select id="ExAdminConfig.SelectAccItemList" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.SelectAccItemList */
		/* 계정과목 관리 / 계정과목 아이템 조회 (풀 스캔) */
		SELECT	
			comp_seq
			, acct_code
			, acct_name
			, vat_yn
			, use_yn
			, parent_code
			, path
		FROM	$DB_NEOS$t_ex_acct 
		WHERE 	CAST(comp_seq AS CHAR ) = #compSeq#
			AND	acct_name	LIKE '%$acctName$%'
		ORDER BY path ASC
	]]></select>

	<insert id="ExAdminConfig.InsertAccItemList" parameterClass="HashMap"><![CDATA[
		/* mariadb/expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.InsertAccItemList */
		/* 계정과목 관리 / 계정과목 아이템 신규 생성 */
		INSERT INTO $DB_NEOS$t_ex_acct (
			comp_seq
			, acct_code
			, acct_name
			, vat_yn
			, use_yn
			, parent_code
			, path
			, create_seq
			, create_date
			, modify_seq
			, modify_date
		)
		VALUES	(
			#compSeq#
			, #acctCode#
			, #acctName#
			, #vatYn#	
			, #useYn#
			, #parentCode#
			, #path#
			, #empSeq#
			, NOW()
			, #empSeq#
			, NOW()
		)	
	]]></insert>

	<update id="ExAdminConfig.UpdateAccItemList" parameterClass="HashMap"><![CDATA[
		/* mariadb/expend/ex/admin/ExAdminConfigSQL.xml - ExAdminConfig.UpdateAccItemList */
		/* 계정과목 관리 / 계정과목 아이템 갱신 */
		UPDATE 	$DB_NEOS$t_ex_acct
		SET	
			acct_name = #acctName#
			, vat_yn = #vatYn#
			, use_yn = #useYn#
			, parent_code = #parentCode#
			, path = #path#
			, modify_seq = #modifySeq#
			, modify_date = NOW()
		WHERE 	comp_seq = #compSeq#
			AND acct_code = #acctCode#
	
	]]></update>

	<select id="ExAdminConfigOptionSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		SELECT	opt.comp_seq
				, opt.form_seq
				, opt.option_gbn
				, opt.option_code
				, mul.option_name
				, opt.use_sw
				, opt.base_value
				, opt.base_name
				, opt.base_emp_value
				, IFNULL(opt.set_value, opt.base_value) AS set_value
				, IFNULL(opt.set_name, opt.base_name) AS base_name
				, opt.set_emp_value
		FROM 	$DB_NEOS$t_ex_option opt
		INNER JOIN $DB_NEOS$t_ex_option_multi mul
		ON 		opt.option_code = mul.option_code AND opt.use_sw = mul.use_sw
		WHERE	opt.comp_seq = '$compSeq$'
		AND		opt.form_seq = '$formSeq$'
		AND		opt.use_sw = '$useSw$'
		AND		opt.option_code = '$optionCode$'
		AND		opt.option_gbn IN ('001','002','003')
		AND		opt.use_yn = 'Y';	
	]]></select>

	<select id="ExAdminLabelInfoListSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml / ExAdminLabelInfoListSelect */
		/* 회사별 전체 명칭설정 정보 조회 */
		SELECT	
			BASE.compSeq						AS 'compSeq'				
			, BASE.langCode						AS 'langCode'
			, BASE.langType						AS 'langType'
			, BASE.basicName					AS 'basicName'
			, BASE.langpackCode				AS	'langpackCode'
			, IFNULL(ADV.langKR, BASE.langKR) 	AS 'langKR'
			, IFNULL(ADV.langEN, BASE.langEN) 	AS 'langEN'
			, IFNULL(ADV.langJP, BASE.langJP) 	AS 'langJP'
			, IFNULL(ADV.langCN, BASE.langCN) 	AS 'langCN'
			, IFNULL(ADV.tooltip, BASE.tooltip) AS 'tooltip'
		FROM	(
			SELECT	
				'$compSeq$'					AS compSeq
				, lang_type					AS langType
				, lang_code					AS langCode
				, basic_name				AS basicName
				, langpack_code				AS langpackCode
				, MAX(IF( lang_type LIKE 'kr', lang_name, '' )) AS langKR
				, MAX(IF( lang_type LIKE 'en', lang_name, '' )) AS langEN
				, MAX(IF( lang_type LIKE 'jp', lang_name, '' )) AS langJP
				, MAX(IF( lang_type LIKE 'cn', lang_name, '' )) AS langCN
				, tooltip					AS tooltip
			FROM	$DB_NEOS$t_ex_langpack
			WHERE 	comp_seq = 'EXP_LANGPACK'
			GROUP BY comp_seq, lang_code
		)	BASE
		 LEFT JOIN	(
			SELECT	
				comp_seq					AS compSeq
				, lang_type					AS langType
				, lang_code					AS langCode
				, basic_name				AS basicName
				, MAX(IF( lang_type LIKE 'kr', lang_name, '' )) AS langKR
				, MAX(IF( lang_type LIKE 'en', lang_name, '' )) AS langEN
				, MAX(IF( lang_type LIKE 'jp', lang_name, '' )) AS langJP
				, MAX(IF( lang_type LIKE 'cn', lang_name, '' )) AS langCN
				, tooltip					AS tooltip
			FROM	$DB_NEOS$t_ex_langpack
			WHERE 	comp_seq = '$compSeq$'
			GROUP BY comp_seq, lang_code
		 )	ADV
		  ON	BASE.langCode = ADV.langCode
	]]></select>

	<update id="ExAdminLabelInfoListUpdate" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminLabelInfoListUpdate */
		/* 명칭정보 갱신 */
		UPDATE	$DB_NEOS$t_ex_langpack
		SET	
			lang_name = '$langName$'
			, modify_seq = '$modifySeq$'
			, modify_date = NOW()
		WHERE	comp_seq = '$compSeq$'
		 AND	lang_type = '$langType$'
		 AND	lang_code = '$langCode$'
	]]></update>

	<update id="ExAdminLabelTolltipInfoListUpdate" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminLabelTolltipInfoListUpdate */
		/* 명칭 툴팁 정보 갱신 */
		UPDATE	$DB_NEOS$t_ex_langpack
		SET	
			tooltip = '$tooltip$'
			, modify_seq = '$modifySeq$'
			, modify_date = NOW()
		WHERE	comp_seq = '$compSeq$'
		 AND	lang_code = '$langCode$'
	]]></update>

	<insert id="ExAdminLabelInfoListInsert" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminLabelInfoListInsert */
		/* 명칭정보 신규 생성 (업데이트 실패의 경우) */
		INSERT INTO $DB_NEOS$t_ex_langpack (comp_seq, lang_type, basic_name, lang_code, langpack_code,lang_name, create_seq, create_date, modify_seq, modify_date, tooltip)
		VALUES	(
			'$compSeq$'
			, '$langType$'
			, '$basicName$'
			, '$langCode$'
			, '$langpackCode$'
			, '$langName$'
			, '$createSeq$'
			, NOW()
			, '$modifySeq$'
			, NOW()
			, '$tooltip$'
		)
	]]></insert>

	<delete id="ExAdminLabelInfoinInitialization" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminLabelInfoinInitialization */
		DELETE
		FROM    $DB_NEOS$t_ex_langpack
		WHERE   `comp_seq` = '$compSeq$'
	]]></delete>

	<insert id="ExAdminLabelInfoWholeInsert" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminLabelInfoWholeInsert */
		/* 명칭정보 최초생성 (기초데이터에서 데이터 전체 복사) */
		INSERT	INTO	$DB_NEOS$t_ex_langpack
		SELECT	
			'$compSeq$'		AS 'comp_seq'
			, lang_seq
			, lang_type
			, basic_name
			, lang_code
			, lang_name
			, '$empSeq$' 	AS 'create_seq'
			, NOW()			AS 'create_date'
			, '$empSeq$'	AS 'modify_seq'
			, NOW()			AS 'modify_date'
		FROM 	$DB_NEOS$t_ex_langpack
		WHERE 	comp_seq = 'EXP_COMPSEQ'
	]]></insert>

	<select id="ExAdminButtonInfoListSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonInfoListSelect */
		/* 버튼 정보 조회 */	
		SELECT	
			comp_seq	AS 'compSeq'
			, form_seq	AS 'formSeq'
			, page_seq	AS 'pageSeq'
			, btn_seq	AS 'btnSeq'
			, POSITION	AS 'position'
			, order_num	AS 'orderNum'
			, display_yn	AS 'displayYN'
			, license_yn	AS 'licenseYN'
			, nm_basic	AS 'nmBasic'
			, nm_kr		AS 'nmKR'
			, nm_en		AS 'nmEN'
			, nm_jp		AS 'nmJP'
			, nm_cn		AS 'nmCN'
			, btn_size	AS 'btnSize'
			, default_yn	AS 'defaultYN'
			, default_code	AS 'defaultCode'
			, call_url	AS 'callURL'
			, call_param	AS 'callParam'
			, callback_url	AS 'callbackUrl'
			, callback_type	AS 'callbackType'
			, callback_key	AS 'callbackKey'
		FROM	$DB_NEOS$t_ex_button
		WHERE 	comp_seq = '$compSeq$'
		 AND	form_seq = '$formSeq$'
		ORDER BY POSITION, order_num	
	]]></select>

	<insert id="ExAdminButtonInfoListCopy" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonInfoListCopy */
		/* 기초데이터에서 데이터 전체 복사 */	
		INSERT INTO	$DB_NEOS$t_ex_button( 
			comp_seq
			, form_seq
			, page_seq
			, POSITION
			, order_num
			, display_yn
			, license_yn
			, btn_size
			, nm_basic
			, nm_kr
			, nm_en
			, nm_jp
			, nm_cn
			, default_yn
			, default_code
			, call_url
			, call_param
			, callback_url
			, callback_type
			, callback_key
			, default_elemId 
			, default_elemClass
		)
		SELECT	
			'$compSeq$'		AS	'comp_seq'
			, '$formSeq$'	AS	'form_seq'
			, BASE.page_seq
			, BASE.POSITION
			, BASE.order_num
			, BASE.display_yn
			, BASE.license_yn
			, BASE.btn_size
			, BASE.nm_basic
			, BASE.nm_kr
			, BASE.nm_en
			, BASE.nm_jp
			, BASE.nm_cn
			, BASE.default_yn
			, BASE.default_code
			, BASE.call_url
			, BASE.call_param
			, BASE.callback_url
			, BASE.callback_type
			, BASE.callback_key
			, BASE.default_elemId 
			, BASE.default_elemClass
		FROM	(
			SELECT	* 
			FROM	$DB_NEOS$t_ex_button 
			WHERE	comp_seq = 'EXP_BUTTON'
			 AND	form_seq = '0'
		)	BASE
			LEFT JOIN 	(
				SELECT	* 
				FROM	$DB_NEOS$t_ex_button 
				WHERE	comp_seq = '$compSeq$'
				 AND	form_seq = '$formSeq$'
			)	ADV
			ON BASE.default_code = ADV.default_code
		WHERE 	ADV.default_code IS NULL
	]]></insert>

	<update id="ExAdminButtonLocationInfoUpdate" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonLocationInfoUpdate */
		/* 버튼 위치정보 갱신 */
		UPDATE	$DB_NEOS$t_ex_button 
		SET		order_num		= '$orderNum$'
				, display_yn	= '$displayYN$'
		WHERE 	comp_seq = '$compSeq$'
		 AND 	form_seq = '$formSeq$'
		 AND	page_seq = '$pageSeq$'
		 AND	btn_seq = '$btnSeq$'
	]]></update>

	<update id="ExAdminButtonInfoUpdate" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonLocationInfoUpdate */
		/* 버튼 상세정보 갱신 */
		UPDATE	$DB_NEOS$t_ex_button 
		SET	nm_basic 	= '$nmBasic$'
			, nm_kr 	= '$nmKR$'
			, nm_en 	= '$nmEN$'
			, nm_cn 	= '$nmCN$'
			, nm_jp 	= '$nmJP$'
			, btn_size 	= '$btnSize$'
			
			, call_url 	= '$callURL$'
			, call_param 	= '$callParam$'
			, callback_url 	= '$callbackURL$'
			, callback_type	= '$callbackType$'
			, callback_key	= '$callbackKey$'
			, license_yn 	= '$licenseYN$'
			
		WHERE 	comp_seq 	= '$compSeq$'
		 AND 	form_seq 	= '$formSeq$'
		 AND	page_seq 	= '$pageSeq$'
		 AND	btn_seq 	= '$btnSeq$'		
	]]></update>

	<update id="ExAdminButtonLicenseInfoUpdate" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonLicenseInfoUpdate */
		/* 버튼 라이선스 정보 갱신 */
		UPDATE	$DB_NEOS$t_ex_button 
		SET		license_yn 	= '$licenseYN$'
		WHERE 	default_code = '$defaultCode$'		
	]]></update>

	<insert id="ExAdminButtonInfoInsert" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonInfoInsert */
		/* 개발자 버튼 데이터 신규 생성 */	
		INSERT INTO	$DB_NEOS$t_ex_button( comp_seq, form_seq, page_seq, POSITION, order_num, display_yn, license_yn, btn_size, nm_basic, nm_kr, nm_en, nm_jp, nm_cn, default_yn, default_code, call_url, call_param, callback_url, callback_type, callback_key ) 
		SELECT	
			'EXP_BUTTON'		AS 'comp_seq'
			, '0'				AS 'form_seq'
			, '$pageSeq$'		AS 'page_seq'
			, '$position$'		AS 'position'
			, '99'				AS 'order_num'
			, 'N'				AS 'display_yn'
			, '$licenseYN$'		AS 'license_yn'
			, '$btnSize$'		AS 'btn_size'
			, '$nmBasic$'		AS 'nm_basic'
			, '$nmKR$'			AS 'nm_kr'
			, '$nmEN$'			AS 'nm_en'
			, '$nmJP$'			AS 'nm_jp'
			, '$nmCN$'			AS 'nm_cn'
			, 'N'				AS 'default_yn'
			, '$defaultCode$'	AS 'default_code'
			, '$callURL$'		AS 'call_url'
			, '$callParam$'		AS 'call_param'
			, ''				AS 'callback_url'
			, '$callbackType$'	AS 'callback_type'
			, '$callbackKey$'	AS 'callback_key'
			FROM	DUAL	
	]]></insert>

	<insert id="ExAdminButtonInfoDelete" parameterClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminButtonInfoInsert */
		/* 개발자 버튼 데이터 삭제 */	
		DELETE 
		FROM 	$DB_NEOS$t_ex_button 
		WHERE 	default_code	= '$defaultCode$' 
		AND 	default_yn		= 'N'
	]]></insert>

	<select id="ExAdminGetFormInfoSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* mariadb/BizboxAlpha/expend/ex/admin/ExAdminConfigSQL.xml /  ExAdminGetFormInfoSelect */
		/* 문서 옵션 조회 */
		SELECT	set_value	AS 	'setValue' 
		FROM	$DB_NEOS$t_ex_option 
		WHERE	comp_Seq = '$compSeq$'
		 AND	form_seq = '$formSeq$'
		 AND 	option_gbn = '001'
		 AND	option_code = '001001' 
		 AND	use_sw = '$useSw$' 	
	]]></select>

	<select id="AdminETaxAuthAllListSelect" parameterClass="HashMap" resultClass="HashMap"><![CDATA[
		/* AdminETaxAuthListAllSelect - mariadb */
		/* parameter : compSeq */
		/* 기능 : 매입전자세금계산서 설정 정보 전체 조회 ( 조건 : 회사 ) */
		
		SELECT  IFNULL(`etax_seq`, '') AS eTaxSeq /* 세금계산서 권한 시퀀스 */
		        , IFNULL(`comp_seq`, '') AS compSeq /* 회사 시퀀스 */
		        , IFNULL(`auth_type`, '') AS authType /* 권한타입 ( P : 거래처 / E : 이메일 ) */
		        , IFNULL(`use_yn`, '') AS useYN /* 사용여부 ( Y : 사용 / N : 미사용 / "" : 미사용 ) */
		        , IFNULL(`name`, '') AS `name` /* 대상 명칭 ( auth_type==P : 거래처명 / auth_type==E : 이메일 주소 ) */
		        , IFNULL(`code`, '') AS `code` /* 대상 코드 ( auth_type==P : 사업자등록번호 / auth_type==E : 이메일 주소 ) */
		        , CASE
		                WHEN (SELECT COUNT(*) FROM $DB_NEOS$t_ex_etax_public WHERE A.etax_seq = etax_seq AND A.comp_seq = comp_seq) > 0 THEN 'Y'
		                ELSE 'N'
		        END AS publicYN /* 공개범위 설정 여부 ( Y : 설정 / N : 미설정 ) */
		        , IFNULL(`public_json`, '') AS publicJson /* 공개범위 JSON */
		FROM    $DB_NEOS$t_ex_etax A
		WHERE   comp_seq = #compSeq#
	]]></select>

	<select id="AdminETaxAuthListSelect" parameterClass="HashMap"
		resultClass="HashMap">
		SELECT etax.etax_seq AS etaxSeq
		, etax.comp_seq AS compSeq
		, etax.auth_type AS authType
		, etax.use_yn AS useYN
		, etax.name
		, etax.code
		, IFNULL(etax.public_json,'') as publicJson
		FROM $DB_NEOS$t_ex_etax etax
		WHERE comp_seq = #compSeq#
		AND
		(
		/* 검새조건 - 권한구분 */
		etax.auth_type LIKE CONCAT('%',#searchType#,'%')
		/* 검새조건 - 사용여부 */
		AND etax.use_yn LIKE CONCAT('%',#searchUseYN#,'%')
		AND (
		/* 검새조건 - 조회대상 */
		etax.name LIKE CONCAT('%',#searchStr#,'%')
		/* 검새조건 - 조회대상 */
		OR etax.code LIKE CONCAT('%',#searchStr#,'%')
		)
		)
		<isNotEqual property="searchType" compareValue="">
			ORDER BY
			etax.name
		</isNotEqual>
	</select>

	<insert id="AdminETaxAuthInsert" parameterClass="HashMap">
		INSERT IGNORE INTO $DB_NEOS$t_ex_etax (`comp_seq`, `auth_type`,
		`use_yn`, `name`, `code`, `public_json`) VALUES (
		#compSeq#
		, #authType#
		, #useYN#
		, #name#
		, #code#
		, #publicJson#
		);
		<selectKey keyProperty="etaxSeq" resultClass="int">
			SELECT
			LAST_INSERT_ID() AS etaxSeq
		</selectKey>
	</insert>

	<delete id="AdminETaxAuthDelete" parameterClass="HashMap">
		DELETE
		FROM
		$DB_NEOS$t_ex_etax
		WHERE comp_seq = #compSeq#
		AND etax_seq = #etaxSeq#;
	</delete>

	<update id="AdminETaxAuthUpdate" parameterClass="HashMap">
		UPDATE
		$DB_NEOS$t_ex_etax
		SET use_yn = #useYN#
		, name = #name#
		, code = #code#
		, public_json = #publicJson#
		WHERE comp_seq = #compSeq#
		AND etax_seq =
		#etaxSeq#;
	</update>

	<select id="AdminETaxAuthPulicSelect" parameterClass="HashMap"
		resultClass="HashMap">
		SELECT etax_seq AS etaxSeq
		, comp_seq AS compSeq
		, type
		, code
		, name
		, group_seq AS groupSeq
		, dept_seq AS deptSeq
		FROM $DB_NEOS$t_ex_etax_public
		WHERE comp_seq = #compSeq#
		AND etax_seq = #etaxSeq#;
	</select>

	<insert id="AdminETaxAuthPulicInsert" parameterClass="HashMap"><![CDATA[
		/* mariadb - AdminETaxAuthPulicInsert - ExAdminConfigSQL.xml*/
		/* 매입전자세금계산서 공개범위 등록 */
		INSERT IGNORE INTO $DB_NEOS$t_ex_etax_public ( `etax_seq`, `comp_seq`, `type`, `code`, `name`, `group_seq`, `dept_seq` )
		VALUES ( #etaxSeq#, #compSeq#, #type#, #code#, #name#, #groupSeq#, #deptSeq# );
	]]></insert>

	<delete id="AdminETaxAuthPulicDelete" parameterClass="HashMap">
		/* mariadb - AdminETaxAuthPulicDelete - ExAdminConfigSQL.xml */
		/* 매입전자세금계산서 공개범위 삭제 */
		DELETE
		FROM
		$DB_NEOS$t_ex_etax_public
		WHERE comp_seq = #compSeq#
		AND etax_seq =
		#etaxSeq#;
	</delete>
	
    <!-- 세금계산서 권한 설정 페이지 - 사업자등록번호 또는 이메일 중복체크 -->
	<select id="AdminETaxAuthCodeDuplicationCheckSelect" parameterClass="HashMap" resultClass="HashMap">
		SELECT COUNT(*) AS duplicationCount
		  FROM $DB_NEOS$t_ex_etax
		 WHERE comp_seq = #compSeq#
		   AND auth_type = #authType#
		   AND CODE = #code#
	</select>

	<!-- /* ## 양식별 표준적요 설정 ## */ -->
	<!-- /* ## 양식별 표준적요 설정 ## - 표준적요 등록 */ -->
	<update id="ExAdminSetSummaryAuthCreate" parameterClass="HashMap"><![CDATA[
		/* 표준적요 등록 */
		INSERT IGNORE INTO $DB_NEOS$t_ex_formlink_summary_auth ( `comp_seq`, `form_seq`, `type_div`, `code_div`, `code`, `create_seq`, `create_date`, `modify_seq`, `modify_date` )
		VALUES ( #compSeq#, #formSeq#, 'summary', 'A', #summaryCode#, #empSeq#, NOW(), #empSeq#, NOW() )
	]]></update>
	<!-- /* ## 양식별 표준적요 설정 ## - 표쥰적요 삭제 */ -->
	<delete id="ExAdminSetSummaryAuthDelete" parameterClass="HashMap">
		/* 표준적요 삭제 */
		DELETE FROM $DB_NEOS$t_ex_formlink_summary_auth 
		 WHERE comp_seq = #compSeq# 
		   AND form_seq = #formSeq# 
		   AND type_div = 'summary' 
		   AND code_div = 'A' 
		 <isNotEqual property="isInsert" compareValue="Y">
		   AND code = #summaryCode#
		 </isNotEqual>
	</delete>
	<!-- /* ## 양식별 증빙유형 설정 ## */ -->
	<!-- /* ## 양식별 증빙유형 설정 ## - 증빙유형 등록 */ -->
	<update id="ExAdminSetAuthTypeAuthCreate" parameterClass="HashMap"><![CDATA[
		/* 증빙유형 등록 */
		INSERT IGNORE INTO $DB_NEOS$t_ex_formlink_summary_auth ( `comp_seq`, `form_seq`, `type_div`, `code_div`, `code`, `create_seq`, `create_date`, `modify_seq`, `modify_date` )
		VALUES ( #compSeq#, #formSeq#, 'auth', 'A', #authTypeCode#, #empSeq#, NOW(), #empSeq#, NOW() )
	]]></update>
	<!-- /* ## 양식별 증빙유형 설정 ## - 증빙유형 삭제 */ -->
	<delete id="ExAdminSetAuthTypeAuthDelete" parameterClass="HashMap">
		/* 증빙유형 삭제 */
		DELETE FROM $DB_NEOS$t_ex_formlink_summary_auth 
		 WHERE comp_seq = #compSeq# 
		   AND form_seq = #formSeq# 
		   AND type_div = 'auth' 
		   AND code_div = 'A' 
		 <isNotEqual property="isInsert" compareValue="Y">
		   AND code = #authTypeCode#
		 </isNotEqual>
	</delete>

	<select id="ExFormLinkAuthListSelect" parameterClass="HashMap"
		resultClass="HashMap">
		SELECT total.auth_code AS authCode
		, total.auth_name AS authName
		, total.vat_type_name AS vatTypeName
		, CASE
		WHEN form.code IS NULL THEN 'N'
		ELSE 'Y'
		END AS hasFormLink
		, (CASE total.order_num WHEN 0 THEN 9999999999 ELSE order_num END)AS
		'orderBy'
		FROM $DB_NEOS$t_ex_auth total
		LEFT OUTER JOIN
		$DB_NEOS$t_ex_formlink_summary_auth form ON (
		total.auth_code = form.code
		AND total.comp_seq = form.comp_seq
		AND form.type_div = 'auth'
		AND form.form_seq = #formSeq#
		)
		WHERE total.comp_seq = #compSeq#
		AND (
		/* 검색조건 - 증빙유형 코드*/
		total.auth_code LIKE CONCAT('%',#searchStr#,'%') OR
		/* 검색조건 - 증빙유형 명칭*/
		total.auth_name LIKE CONCAT('%',#searchStr#,'%')
		)
		ORDER BY hasFormLink DESC, orderBy;
	</select>

	<select id="ExFormLinkSummaryListSelect" parameterClass="HashMap"
		resultClass="HashMap">
		SELECT total.summary_code AS summaryCode
		, total.summary_name AS summaryName
		, total.dr_acct_name AS drAcctName
		, total.vat_acct_name AS vatAcctName
		, total.cr_acct_name AS crAcctName
		, CASE
		WHEN form.code IS NULL THEN 'N'
		ELSE 'Y'
		END AS hasFormLink
		, (CASE total.order_num WHEN 0 THEN 9999999999 ELSE order_num END)AS
		'orderBy'
		FROM $DB_NEOS$t_ex_summary total
		LEFT OUTER JOIN
		$DB_NEOS$t_ex_formlink_summary_auth form ON (
		total.summary_code = form.code
		AND total.comp_seq = form.comp_seq
		AND form.type_div = 'summary'
		AND form.form_seq = #formSeq#

		)
		WHERE total.comp_seq = #compSeq#
		AND (
		/* 검색조건 - 표준적요 코드*/
		total.summary_code LIKE CONCAT('%',#searchStr#,'%') OR
		/* 검색조건 - 표준적요 명칭*/
		total.summary_name LIKE CONCAT('%',#searchStr#,'%')
		)
		ORDER BY hasFormLink DESC, orderBy,
		total.summary_name, total.summary_code;
	</select>

	<!-- /* ## 양식별 증빙유형 설정 ## - 증빙유형 링크 리스트 조회 */ -->
	<select id="ExFormLinkSettingAuthListSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		SELECT  A.`comp_seq` AS compSeq
		        , A.`form_seq` AS formSeq
		        , A.`type_div` AS typeDiv
		        , A.`code_div` AS codeDiv
		        , B.`auth_name` AS authName
		        , B.`auth_code` AS authCode
		        , B.`vat_type_code` AS vatTypeCode
		        , B.`vat_type_name` AS vatTypeName
		FROM    (
		                SELECT  `comp_seq`
		                        , `form_seq`
		                        , `type_div`
		                        , `code_div`
		                        , `code`
		                FROM    $DB_NEOS$t_ex_formlink_summary_auth
		                WHERE   `comp_seq` = #compSeq#
		                AND     `form_seq` = #formSeq#
		                AND     `type_div` = 'auth'
		                AND     `code_div` = 'A'
		        ) A INNER JOIN (
		                SELECT  `comp_seq`
		                        , `auth_name`
		                        , `auth_code`
		                        , `vat_type_code`
		                        , `vat_type_name`
		                        , (CASE WHEN `order_num` = 0 THEN 9999999999 ELSE `order_num` END) AS order_num
		                FROM    $DB_NEOS$t_ex_auth
		                WHERE   `comp_seq` = #compSeq#
		                AND     `auth_div` = 'A'
		        ) B ON A.`comp_seq`  = B.`comp_seq` AND A.`code` = B.`auth_code`
		ORDER   BY B.`order_num`, B.`auth_name`, B.`auth_code`

	]]></select>

	<!-- /* ## 양식별 증빙유형 설정 ## - 표준적요 링크 리스트 조회 */ -->
	<select id="ExFormLinkSettingSummaryListSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		SELECT  A.`comp_seq` AS compSeq
		        , A.`form_seq` AS formSeq
		        , A.`type_div` AS typeDiv
		        , A.`code_div` AS codeDiv
		        , B.`summary_name` AS summaryName
		        , B.`summary_code` AS summaryCode
		        , B.`dr_acct_name` AS drAcctName
		        , B.`dr_acct_code` AS drAcctCode
		        , B.`vat_acct_name` AS vatAcctName
		        , B.`vat_acct_code` AS vatAcctCode
		        , B.`cr_acct_code` AS crAcctCode
		        , B.`cr_acct_name` AS crAcctName
		FROM    (
		                SELECT  `comp_seq`
		                        , `form_seq`
		                        , `type_div`
		                        , `code_div`
		                        , `code`
		                FROM    $DB_NEOS$t_ex_formlink_summary_auth
		                WHERE   `comp_seq` = #compSeq#
		                AND     `form_seq` = #formSeq#
		                AND     `type_div` = 'summary'
		                AND     `code_div` = 'A'
		        ) A INNER JOIN (
		                SELECT  `comp_seq`
		                        , `summary_name`
		                        , `summary_code`
		                        , `dr_acct_name`
		                        , `dr_acct_code`
		                        , IFNULL(`vat_acct_name`, '') AS `vat_acct_name`
		                        , IFNULL(`vat_acct_code`, '') AS `vat_acct_code`
		                        , `cr_acct_code`
		                        , `cr_acct_name`
		                        , (CASE WHEN `order_num` = 0 THEN 9999999999 ELSE `order_num` END) AS order_num
		                FROM    $DB_NEOS$t_ex_summary
		                WHERE   `comp_seq` = #compSeq#
		AND     `summary_div` = 'A'
		        ) B ON A.`comp_seq`  = B.`comp_seq` AND A.`code` = B.`summary_code`
		ORDER   BY B.`order_num`, B.`summary_name`, B.`summary_code`
	]]></select>


	<insert id="ExAdminExpendCloseInsert" parameterClass="HashMap">
		/* 지출결의 마감 등록 */
		INSERT INTO $DB_NEOS$t_ex_close
		(comp_seq,form_seq,seq,close_type,close_from_date,close_to_date,close_stat,note,create_seq,create_date,modify_seq,modify_name,modify_date)
		SELECT #compSeq#,#formSeq#,(IFNULL(MAX(seq),0) +
		1),#closeType#,#closeFromDate#,#closeToDate#,#closeStat#,#note#,#createSeq#,NOW(),#modifySeq#,#modifyName#,NOW()
		FROM $DB_NEOS$t_ex_close WHERE comp_seq = #compSeq# AND form_Seq =
		#formSeq#
		<selectKey keyProperty="seq" resultClass="int">
			SELECT MAX(seq) FROM $DB_NEOS$t_ex_close WHERE comp_seq = #compSeq# AND
			form_Seq = #formSeq#
		</selectKey>
	</insert>

	<insert id="ExAdminExpendCloseInsertAllForm" parameterClass="HashMap">
		/* 지출결의 마감 등록(전체양식) */
		INSERT INTO $DB_NEOS$t_ex_close 
		(comp_seq,form_seq,seq,close_type,close_from_date,close_to_date,close_stat,note,create_seq,create_date,modify_seq,modify_name,modify_date)
		SELECT #compSeq#
		     , A.form_id
		     , ( SELECT (IFNULL(MAX(seq),0) + 1) 
			       FROM $DB_NEOS$t_ex_close 
			      WHERE comp_seq = #compSeq# 
			        AND form_seq = A.form_id )
		     , #closeType#
		     , #closeFromDate#
		     , #closeToDate#
		     , #closeStat#
		     , #note#
		     , #createSeq#
		     , NOW()
		     , #modifySeq#
		     , #modifyName#
		     , NOW()
		  FROM $DB_NEOS$TEAG_FORM A 
		 WHERE FORM_TP = 'EA0000' 
		   AND FORM_D_TP IN ( 'EXPENDI', 'EXPENDU', 'EXPENDA' ) 
         <isNotEmpty property="exceptFormList">
           AND form_id NOT IN
			   <iterate property="exceptFormList" open="(" close=")" conjunction=","> 
			     #exceptFormList[].formSeq# 
			   </iterate>
         </isNotEmpty>
	</insert>

	<update id="ExAdminExpendCloseUpdate" parameterClass="HashMap">
		/* 지출결의 마감
		수정 */
		UPDATE $DB_NEOS$t_ex_close
		SET close_type = #closeType#
		  , close_from_date = #closeFromDate#
		  , close_to_date = #closeToDate#
		  , close_stat = #closeStat#
		  , note = #note#
		  , modify_seq = #modifySeq#
		  , modify_name = #modifyName#
		  , modify_date = NOW()
		WHERE comp_seq = #compSeq#
		AND form_seq = #formSeq#
		AND seq = #seq#;
	</update>

	<delete id="ExAdminExpendCloseDelete" parameterClass="HashMap">
		/* 지출결의 마감
		삭제 */
		DELETE
		FROM $DB_NEOS$t_ex_close
		WHERE comp_seq = #compSeq#
		AND
		form_seq = #formSeq#
		AND seq = #seq#;
	</delete>

	<select id="ExAdminExpendCloseSelect" parameterClass="HashMap"
		resultClass="HashMap"><![CDATA[
		/* 지출결의 마감 조회 */
		SELECT	comp_seq AS compSeq
				, form_seq AS formSeq
				, seq AS seq
				, close_type AS closeType 
				, close_from_date AS closeFromDate
				, close_to_date AS closeToDate
				, close_stat AS closeStat
				, note AS note
				, create_seq AS createSeq 
				, create_date AS createDate
				, modify_seq AS modifySeq
				, modify_name AS modifyName
				, DATE_FORMAT(modify_date,"%Y%m%d") AS modifyDate
		FROM	$DB_NEOS$t_ex_close
		WHERE	comp_seq = #compSeq#
		AND		form_seq = #formSeq#
		/* 검색조건 - 마감기간 */
		AND		(
			( close_from_date BETWEEN #fromDate# AND #toDate# ) OR
			( close_to_date BETWEEN #fromDate# AND #toDate# ) OR
			( close_from_date <= #fromDate# AND close_to_date >= #toDate#)
		)
		/* 검색조건 - 마감구분 */
		AND		close_type LIKE CONCAT('%',#closeType#,'%')
		/* 검색조건 - 마감상태 */
		AND		close_stat LIKE CONCAT('%',#closeStat#,'%')
		/* 검색조건 - 마감자 */
		AND	(
			modify_seq LIKE CONCAT('%',#modifyStr#,'%') OR
			modify_name LIKE CONCAT('%',#modifyStr#,'%')
		)
		ORDER BY close_from_date DESC;
	]]></select>

	<insert id="ExAdminExpendCloseHistoryInsert" parameterClass="HashMap">
		/* 지출결의 마감 이력 등록 */
		INSERT INTO $DB_NEOS$t_ex_close_history
		(comp_seq,form_seq,close_seq,seq,close_stat,hitory_info,create_seq,create_date)
		SELECT #compSeq#,#formSeq#,#closeSeq#,(IFNULL(MAX(seq),0) +
		1),#closeStat#,#historyInfo#,#createSeq#,NOW()
		FROM
		$DB_NEOS$t_ex_close_history WHERE comp_seq = #compSeq# AND form_Seq =
		#formSeq# AND close_seq = #closeSeq#
		<selectKey keyProperty="seq" resultClass="int">
			SELECT MAX(seq) FROM $DB_NEOS$t_ex_close_history WHERE comp_seq = #compSeq#
			AND form_Seq = #formSeq# AND close_seq = #closeSeq#
		</selectKey>
	</insert>

	<select id="ExAdminExpendCloseFormInsertChkValidate"
		parameterClass="HashMap" resultClass="HashMap"><![CDATA[
		SELECT	form_seq AS formSeq
		FROM	$DB_NEOS$t_ex_close
		WHERE	comp_seq = #compSeq#
		AND		close_type = #closeType#
		AND		close_stat = 'Y'
		AND		(
			#closeFromDate# BETWEEN close_from_date AND close_to_date OR
			#closeToDate# BETWEEN close_from_date AND close_to_date OR
			(#closeFromDate# <= close_from_date AND close_to_date <= #closeToDate# )
		)
		GROUP BY form_seq;
	]]></select>

	<select id="ExAdminExpendCloseFormInsertChkValidateOneForm"
		parameterClass="HashMap" resultClass="HashMap"><![CDATA[
		SELECT	form_seq AS formSeq
		FROM	$DB_NEOS$t_ex_close
		WHERE	comp_seq = #compSeq#
		AND		form_seq = #formSeq#
		AND		close_type = #closeType#
		AND		close_stat = 'Y'
		AND		(
			#closeFromDate# BETWEEN close_from_date AND close_to_date OR
			#closeToDate# BETWEEN close_from_date AND close_to_date OR
			(#closeFromDate# <= close_from_date AND close_to_date <= #closeToDate# )
		)
	]]></select>
</sqlMap>